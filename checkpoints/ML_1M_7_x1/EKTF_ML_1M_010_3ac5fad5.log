2024-09-20 23:54:37,013 P2827 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "1",
    "group_id": "None",
    "hidden_activations": "relu",
    "hidden_units": "[400, 400, 400]",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "EKTF",
    "model_id": "EKTF_ML_1M_010_3ac5fad5",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_student": "5",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML_1M/test.csv",
    "train_data": "../../../data/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-20 23:54:37,013 P2827 INFO Set up feature processor...
2024-09-20 23:54:37,014 P2827 WARNING Skip rebuilding ../../../data/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-20 23:54:37,014 P2827 INFO Load feature_map from json: ../../../data/ML_1M_7_x1/feature_map.json
2024-09-20 23:54:37,014 P2827 INFO Set column index...
2024-09-20 23:54:37,014 P2827 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20, 'max_len': 5}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3642, 'vocab_size': 3643}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}"
}
2024-09-20 23:54:41,192 P2827 INFO Total number of parameters: 2000021.
2024-09-20 23:54:41,192 P2827 INFO Loading data...
2024-09-20 23:54:41,192 P2827 INFO Loading data from h5: ../../../data/ML_1M_7_x1/train.h5
2024-09-20 23:54:41,254 P2827 INFO Train samples: total/591209, blocks/1
2024-09-20 23:54:41,254 P2827 INFO Loading data from h5: ../../../data/ML_1M_7_x1/valid.h5
2024-09-20 23:54:41,260 P2827 INFO Validation samples: total/73901, blocks/1
2024-09-20 23:54:41,260 P2827 INFO Loading train and validation data done.
2024-09-20 23:54:41,260 P2827 INFO Start training: 145 batches/epoch
2024-09-20 23:54:41,260 P2827 INFO ************ Epoch=1 start ************
2024-09-20 23:55:19,100 P2827 INFO Train loss: 0.418298
2024-09-20 23:55:19,100 P2827 INFO Evaluation @epoch 1 - batch 145: 
2024-09-20 23:55:20,311 P2827 INFO Student 1: [Metrics] AUC: 0.873400 - logloss: 0.342226
2024-09-20 23:55:20,399 P2827 INFO Student 2: [Metrics] AUC: 0.873240 - logloss: 0.342130
2024-09-20 23:55:20,487 P2827 INFO Student 3: [Metrics] AUC: 0.872949 - logloss: 0.342917
2024-09-20 23:55:20,553 P2827 INFO Student 4: [Metrics] AUC: 0.873723 - logloss: 0.341704
2024-09-20 23:55:20,608 P2827 INFO Student 5: [Metrics] AUC: 0.872902 - logloss: 0.342575
2024-09-20 23:55:20,662 P2827 INFO Teacher: [Metrics] AUC: 0.874081 - logloss: 0.341341
2024-09-20 23:55:20,667 P2827 INFO Save best model: monitor(max)=0.874081
2024-09-20 23:55:20,769 P2827 INFO ************ Epoch=1 end ************
2024-09-20 23:55:58,375 P2827 INFO Train loss: 0.367323
2024-09-20 23:55:58,375 P2827 INFO Evaluation @epoch 2 - batch 145: 
2024-09-20 23:55:59,602 P2827 INFO Student 1: [Metrics] AUC: 0.883297 - logloss: 0.331062
2024-09-20 23:55:59,658 P2827 INFO Student 2: [Metrics] AUC: 0.883055 - logloss: 0.331236
2024-09-20 23:55:59,715 P2827 INFO Student 3: [Metrics] AUC: 0.883039 - logloss: 0.330993
2024-09-20 23:55:59,777 P2827 INFO Student 4: [Metrics] AUC: 0.883176 - logloss: 0.330802
2024-09-20 23:55:59,835 P2827 INFO Student 5: [Metrics] AUC: 0.882962 - logloss: 0.331098
2024-09-20 23:55:59,893 P2827 INFO Teacher: [Metrics] AUC: 0.883685 - logloss: 0.330314
2024-09-20 23:55:59,899 P2827 INFO Save best model: monitor(max)=0.883685
2024-09-20 23:56:00,104 P2827 INFO ************ Epoch=2 end ************
2024-09-20 23:56:37,754 P2827 INFO Train loss: 0.359483
2024-09-20 23:56:37,755 P2827 INFO Evaluation @epoch 3 - batch 145: 
2024-09-20 23:56:39,305 P2827 INFO Student 1: [Metrics] AUC: 0.890252 - logloss: 0.321780
2024-09-20 23:56:39,368 P2827 INFO Student 2: [Metrics] AUC: 0.890313 - logloss: 0.321976
2024-09-20 23:56:39,429 P2827 INFO Student 3: [Metrics] AUC: 0.890028 - logloss: 0.322180
2024-09-20 23:56:39,489 P2827 INFO Student 4: [Metrics] AUC: 0.890021 - logloss: 0.322403
2024-09-20 23:56:39,549 P2827 INFO Student 5: [Metrics] AUC: 0.889979 - logloss: 0.322256
2024-09-20 23:56:39,610 P2827 INFO Teacher: [Metrics] AUC: 0.890655 - logloss: 0.321434
2024-09-20 23:56:39,616 P2827 INFO Save best model: monitor(max)=0.890655
2024-09-20 23:56:39,863 P2827 INFO ************ Epoch=3 end ************
2024-09-20 23:57:17,734 P2827 INFO Train loss: 0.354579
2024-09-20 23:57:17,735 P2827 INFO Evaluation @epoch 4 - batch 145: 
2024-09-20 23:57:18,813 P2827 INFO Student 1: [Metrics] AUC: 0.893306 - logloss: 0.318291
2024-09-20 23:57:18,874 P2827 INFO Student 2: [Metrics] AUC: 0.893564 - logloss: 0.317592
2024-09-20 23:57:18,931 P2827 INFO Student 3: [Metrics] AUC: 0.893109 - logloss: 0.318246
2024-09-20 23:57:18,986 P2827 INFO Student 4: [Metrics] AUC: 0.893157 - logloss: 0.318135
2024-09-20 23:57:19,040 P2827 INFO Student 5: [Metrics] AUC: 0.893357 - logloss: 0.317784
2024-09-20 23:57:19,096 P2827 INFO Teacher: [Metrics] AUC: 0.893711 - logloss: 0.317430
2024-09-20 23:57:19,101 P2827 INFO Save best model: monitor(max)=0.893711
2024-09-20 23:57:19,221 P2827 INFO ************ Epoch=4 end ************
2024-09-20 23:57:56,734 P2827 INFO Train loss: 0.351573
2024-09-20 23:57:56,734 P2827 INFO Evaluation @epoch 5 - batch 145: 
2024-09-20 23:57:57,865 P2827 INFO Student 1: [Metrics] AUC: 0.894772 - logloss: 0.316266
2024-09-20 23:57:57,902 P2827 INFO Student 2: [Metrics] AUC: 0.894996 - logloss: 0.315774
2024-09-20 23:57:57,942 P2827 INFO Student 3: [Metrics] AUC: 0.894712 - logloss: 0.316452
2024-09-20 23:57:57,979 P2827 INFO Student 4: [Metrics] AUC: 0.895084 - logloss: 0.316081
2024-09-20 23:57:58,018 P2827 INFO Student 5: [Metrics] AUC: 0.894866 - logloss: 0.316070
2024-09-20 23:57:58,056 P2827 INFO Teacher: [Metrics] AUC: 0.895309 - logloss: 0.315526
2024-09-20 23:57:58,059 P2827 INFO Save best model: monitor(max)=0.895309
2024-09-20 23:57:58,199 P2827 INFO ************ Epoch=5 end ************
2024-09-20 23:58:35,678 P2827 INFO Train loss: 0.349303
2024-09-20 23:58:35,678 P2827 INFO Evaluation @epoch 6 - batch 145: 
2024-09-20 23:58:36,866 P2827 INFO Student 1: [Metrics] AUC: 0.895896 - logloss: 0.314478
2024-09-20 23:58:36,921 P2827 INFO Student 2: [Metrics] AUC: 0.896150 - logloss: 0.313927
2024-09-20 23:58:36,977 P2827 INFO Student 3: [Metrics] AUC: 0.895625 - logloss: 0.314649
2024-09-20 23:58:37,031 P2827 INFO Student 4: [Metrics] AUC: 0.895759 - logloss: 0.314666
2024-09-20 23:58:37,085 P2827 INFO Student 5: [Metrics] AUC: 0.895621 - logloss: 0.315183
2024-09-20 23:58:37,141 P2827 INFO Teacher: [Metrics] AUC: 0.896182 - logloss: 0.314048
2024-09-20 23:58:37,146 P2827 INFO Save best model: monitor(max)=0.896182
2024-09-20 23:58:37,281 P2827 INFO ************ Epoch=6 end ************
2024-09-20 23:59:15,071 P2827 INFO Train loss: 0.347172
2024-09-20 23:59:15,071 P2827 INFO Evaluation @epoch 7 - batch 145: 
2024-09-20 23:59:16,362 P2827 INFO Student 1: [Metrics] AUC: 0.896963 - logloss: 0.312792
2024-09-20 23:59:16,409 P2827 INFO Student 2: [Metrics] AUC: 0.897222 - logloss: 0.312354
2024-09-20 23:59:16,446 P2827 INFO Student 3: [Metrics] AUC: 0.897124 - logloss: 0.312479
2024-09-20 23:59:16,482 P2827 INFO Student 4: [Metrics] AUC: 0.897149 - logloss: 0.312417
2024-09-20 23:59:16,519 P2827 INFO Student 5: [Metrics] AUC: 0.896821 - logloss: 0.312845
2024-09-20 23:59:16,563 P2827 INFO Teacher: [Metrics] AUC: 0.897465 - logloss: 0.312029
2024-09-20 23:59:16,567 P2827 INFO Save best model: monitor(max)=0.897465
2024-09-20 23:59:16,687 P2827 INFO ************ Epoch=7 end ************
2024-09-20 23:59:54,200 P2827 INFO Train loss: 0.345641
2024-09-20 23:59:54,201 P2827 INFO Evaluation @epoch 8 - batch 145: 
2024-09-20 23:59:55,544 P2827 INFO Student 1: [Metrics] AUC: 0.896297 - logloss: 0.313387
2024-09-20 23:59:55,598 P2827 INFO Student 2: [Metrics] AUC: 0.896720 - logloss: 0.312968
2024-09-20 23:59:55,653 P2827 INFO Student 3: [Metrics] AUC: 0.896456 - logloss: 0.313156
2024-09-20 23:59:55,708 P2827 INFO Student 4: [Metrics] AUC: 0.896508 - logloss: 0.313263
2024-09-20 23:59:55,766 P2827 INFO Student 5: [Metrics] AUC: 0.896366 - logloss: 0.313218
2024-09-20 23:59:55,824 P2827 INFO Teacher: [Metrics] AUC: 0.896861 - logloss: 0.312628
2024-09-20 23:59:55,829 P2827 INFO Monitor(max)=0.896861 STOP!
2024-09-20 23:59:55,829 P2827 INFO Reduce learning rate on plateau: 0.000100
2024-09-20 23:59:55,937 P2827 INFO ************ Epoch=8 end ************
2024-09-21 00:00:33,748 P2827 INFO Train loss: 0.303943
2024-09-21 00:00:33,748 P2827 INFO Evaluation @epoch 9 - batch 145: 
2024-09-21 00:00:34,803 P2827 INFO Student 1: [Metrics] AUC: 0.903293 - logloss: 0.306118
2024-09-21 00:00:34,866 P2827 INFO Student 2: [Metrics] AUC: 0.903542 - logloss: 0.306121
2024-09-21 00:00:34,921 P2827 INFO Student 3: [Metrics] AUC: 0.903330 - logloss: 0.306194
2024-09-21 00:00:34,976 P2827 INFO Student 4: [Metrics] AUC: 0.903289 - logloss: 0.306399
2024-09-21 00:00:35,030 P2827 INFO Student 5: [Metrics] AUC: 0.903185 - logloss: 0.306576
2024-09-21 00:00:35,085 P2827 INFO Teacher: [Metrics] AUC: 0.903712 - logloss: 0.305626
2024-09-21 00:00:35,090 P2827 INFO Save best model: monitor(max)=0.903712
2024-09-21 00:00:35,228 P2827 INFO ************ Epoch=9 end ************
2024-09-21 00:01:12,689 P2827 INFO Train loss: 0.284937
2024-09-21 00:01:12,690 P2827 INFO Evaluation @epoch 10 - batch 145: 
2024-09-21 00:01:13,796 P2827 INFO Student 1: [Metrics] AUC: 0.904256 - logloss: 0.306606
2024-09-21 00:01:13,854 P2827 INFO Student 2: [Metrics] AUC: 0.904355 - logloss: 0.306653
2024-09-21 00:01:13,912 P2827 INFO Student 3: [Metrics] AUC: 0.904240 - logloss: 0.306619
2024-09-21 00:01:13,968 P2827 INFO Student 4: [Metrics] AUC: 0.904183 - logloss: 0.306965
2024-09-21 00:01:14,024 P2827 INFO Student 5: [Metrics] AUC: 0.904198 - logloss: 0.307018
2024-09-21 00:01:14,081 P2827 INFO Teacher: [Metrics] AUC: 0.904673 - logloss: 0.305989
2024-09-21 00:01:14,090 P2827 INFO Save best model: monitor(max)=0.904673
2024-09-21 00:01:14,238 P2827 INFO ************ Epoch=10 end ************
2024-09-21 00:01:51,798 P2827 INFO Train loss: 0.274492
2024-09-21 00:01:51,798 P2827 INFO Evaluation @epoch 11 - batch 145: 
2024-09-21 00:01:52,914 P2827 INFO Student 1: [Metrics] AUC: 0.904243 - logloss: 0.310024
2024-09-21 00:01:52,968 P2827 INFO Student 2: [Metrics] AUC: 0.904278 - logloss: 0.310068
2024-09-21 00:01:53,023 P2827 INFO Student 3: [Metrics] AUC: 0.904130 - logloss: 0.310210
2024-09-21 00:01:53,077 P2827 INFO Student 4: [Metrics] AUC: 0.903997 - logloss: 0.310351
2024-09-21 00:01:53,131 P2827 INFO Student 5: [Metrics] AUC: 0.904043 - logloss: 0.310549
2024-09-21 00:01:53,187 P2827 INFO Teacher: [Metrics] AUC: 0.904608 - logloss: 0.309331
2024-09-21 00:01:53,192 P2827 INFO Monitor(max)=0.904608 STOP!
2024-09-21 00:01:53,192 P2827 INFO Reduce learning rate on plateau: 0.000010
2024-09-21 00:01:53,301 P2827 INFO ************ Epoch=11 end ************
2024-09-21 00:02:30,918 P2827 INFO Train loss: 0.256319
2024-09-21 00:02:30,918 P2827 INFO Evaluation @epoch 12 - batch 145: 
2024-09-21 00:02:32,043 P2827 INFO Student 1: [Metrics] AUC: 0.903745 - logloss: 0.312416
2024-09-21 00:02:32,100 P2827 INFO Student 2: [Metrics] AUC: 0.903865 - logloss: 0.312821
2024-09-21 00:02:32,155 P2827 INFO Student 3: [Metrics] AUC: 0.903618 - logloss: 0.312896
2024-09-21 00:02:32,209 P2827 INFO Student 4: [Metrics] AUC: 0.903586 - logloss: 0.312969
2024-09-21 00:02:32,264 P2827 INFO Student 5: [Metrics] AUC: 0.903621 - logloss: 0.313312
2024-09-21 00:02:32,318 P2827 INFO Teacher: [Metrics] AUC: 0.904176 - logloss: 0.311900
2024-09-21 00:02:32,323 P2827 INFO Monitor(max)=0.904176 STOP!
2024-09-21 00:02:32,323 P2827 INFO Reduce learning rate on plateau: 0.000001
2024-09-21 00:02:32,323 P2827 INFO ********* Epoch==12 early stop *********
2024-09-21 00:02:32,400 P2827 INFO Training finished.
2024-09-21 00:02:32,400 P2827 INFO Load best model: /mnt/public/lhh/code/model_zoo/EKTF/EKTF_torch/checkpoints/ML_1M_7_x1/EKTF_ML_1M_010_3ac5fad5.model
2024-09-21 00:02:32,427 P2827 INFO ****** Validation evaluation ******
2024-09-21 00:02:33,578 P2827 INFO Student 1: [Metrics] logloss: 0.306606 - AUC: 0.904256
2024-09-21 00:02:33,615 P2827 INFO Student 2: [Metrics] logloss: 0.306653 - AUC: 0.904355
2024-09-21 00:02:33,652 P2827 INFO Student 3: [Metrics] logloss: 0.306619 - AUC: 0.904240
2024-09-21 00:02:33,691 P2827 INFO Student 4: [Metrics] logloss: 0.306965 - AUC: 0.904183
2024-09-21 00:02:33,733 P2827 INFO Student 5: [Metrics] logloss: 0.307018 - AUC: 0.904198
2024-09-21 00:02:33,770 P2827 INFO Teacher: [Metrics] logloss: 0.305989 - AUC: 0.904673
2024-09-21 00:02:33,808 P2827 INFO ******** Test evaluation ********
2024-09-21 00:02:33,808 P2827 INFO Loading data...
2024-09-21 00:02:33,808 P2827 INFO Loading data from h5: ../../../data/ML_1M_7_x1/test.h5
2024-09-21 00:02:33,815 P2827 INFO Test samples: total/73902, blocks/1
2024-09-21 00:02:33,815 P2827 INFO Loading test data done.
2024-09-21 00:02:34,889 P2827 INFO Student 1: [Metrics] logloss: 0.304322 - AUC: 0.905842
2024-09-21 00:02:34,925 P2827 INFO Student 2: [Metrics] logloss: 0.304693 - AUC: 0.905579
2024-09-21 00:02:34,962 P2827 INFO Student 3: [Metrics] logloss: 0.304278 - AUC: 0.905787
2024-09-21 00:02:34,998 P2827 INFO Student 4: [Metrics] logloss: 0.304636 - AUC: 0.905724
2024-09-21 00:02:35,034 P2827 INFO Student 5: [Metrics] logloss: 0.304035 - AUC: 0.906130
2024-09-21 00:02:35,071 P2827 INFO Teacher: [Metrics] logloss: 0.303615 - AUC: 0.906243
